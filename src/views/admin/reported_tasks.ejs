<div class="section-title">Reported Tasks</div>
<div class="glass-panel" style="overflow-x:auto;">
  <table style="width:100%;border-collapse:collapse;color:white;">
    <thead>
      <tr style="text-align:left;color:#94a3b8;border-bottom:1px solid rgba(255,255,255,0.1);">
        <th style="padding:12px;">ID</th>
        <th style="padding:12px;">Link / Owner</th>
        <th style="padding:12px;">Visitor</th>
        <th style="padding:12px;">Report Details</th>
        <th style="padding:12px;">Proofs</th>
        <th style="padding:12px;">Actions</th>
      </tr>
    </thead>
    <tbody>
      <% if (tasks.length === 0) { %>
        <tr>
          <td colspan="6" style="padding:20px;text-align:center;color:#94a3b8;">No reported tasks found.</td>
        </tr>
      <% } %>
      <% tasks.forEach(task => { %>
        <tr style="border-bottom:1px solid rgba(255,255,255,0.05);">
          <td style="padding:12px;">#<%= task.id %></td>
          <td style="padding:12px;">
            <div style="font-weight:bold;color:#f472b6;"><%= task.promotedLink.title %></div>
            <div style="font-size:12px;color:#94a3b8;">Owner: <%= task.promotedLink.user.username %></div>
          </td>
          <td style="padding:12px;">
            <div style="font-weight:bold;"><%= task.visitor.username %></div>
            <div style="font-size:12px;color:#94a3b8;">ID: <%= task.visitor.id %></div>
          </td>
          <td style="padding:12px;max-width:250px;">
            <div style="background:rgba(239,68,68,0.1);padding:8px;border-radius:4px;margin-bottom:4px;font-size:12px;">
              <span style="color:#f87171;font-weight:bold;">Rejection:</span> <%= task.rejectionReason %>
            </div>
            <div style="background:rgba(168,85,247,0.1);padding:8px;border-radius:4px;font-size:12px;">
              <span style="color:#c084fc;font-weight:bold;">Report:</span> <%= task.reportMessage %>
            </div>
            <div style="font-size:11px;color:#94a3b8;margin-top:4px;">
              <%= new Date(task.reportedAt).toLocaleString() %>
            </div>
          </td>
          <td style="padding:12px;">
            <div style="display:flex;gap:4px;flex-wrap:wrap;">
              <% task.screenshots.forEach(url => { %>
                <a href="<%= url %>" target="_blank">
                  <img src="<%= url %>" style="width:40px;height:40px;object-fit:cover;border-radius:4px;border:1px solid rgba(255,255,255,0.1);">
                </a>
              <% }) %>
            </div>
          </td>
          <td style="padding:12px;">
            <div style="display:flex;flex-direction:column;gap:6px;">
              <!-- Approve (Visitor Wins) -->
              <form action="/admin/reported/action" method="POST">
                <input type="hidden" name="id" value="<%= task.id %>">
                <input type="hidden" name="action" value="approve">
                <button type="submit" class="btn-premium" style="width:100%;font-size:11px;padding:6px;background:linear-gradient(135deg, #22c55e, #16a34a);">
                  Visitor Wins (Pay)
                </button>
              </form>
              <!-- Reject (Owner Wins) -->
              <form action="/admin/reported/action" method="POST">
                <input type="hidden" name="id" value="<%= task.id %>">
                <input type="hidden" name="action" value="reject">
                <button type="submit" class="btn-premium" style="width:100%;font-size:11px;padding:6px;background:linear-gradient(135deg, #ef4444, #dc2626);">
                  Owner Wins (Refund)
                </button>
              </form>
            </div>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>
</div>
